06. 불균형 클래스 다루기 

스팸메일, 폐암에 걸린 사람 데이터 등과 같은 범주 데이터는 기본적으로 클래스가 불균형한 경우가 많다. 

(상식적으로 정상메일 비율>> 스팸메일 비율,  정상인 비율 >> 폐암 환자 비율일 것이므로) 

이런 데이터의 경우 정확도가 아무리 높게 나와도 재현율(recall-rate) 지표는 현저하게 낮게 나온다.

**해결법**

1. Over-sampling 기법

갯수가 적은 쪽 클래스의 데이터를 랜덤하게 복제해서 갯수를 맞춤 

2. Under-sampling 기법

갯수가 많은 쪽 클래스의 데이터를 랜덤하게 갯수를 줄여서 적은 쪽 클래스와 갯수를 맞춤

3. 틀린 데이터들의 오류에 대해 큰 벌칙 부과하기 

데이터 갯수가 더 적은 클래스에 대해 잘못 예측했을 때의 벌점을 더 크게 부과한다. 

사이킷런에 있는 대부분의 분류기 함수 내에는 class_weight 이라는 옵션이 있는데, 이를 이용할 수 있다. 

4. SMOTE 기법

군집분석 에서 knn 기법을 떠올리면 이해하기 쉽다. 

적은 데이터들 중에서 한 지점을 잡는다. 최근접 이웃 데이터와의 거리 차이를 계산한다. 이 차이에 0과 1사이의 난수를 곱한다. 

이를 기반으로 해서 랜덤하게 해당 데이터 포인트와 최근접 이웃 데이터 포인트들 사이에 새로운 데이터 포인트들을 집어 넣는다. 



